# 软件单元测试入门与实践

## 软件测试基础知识

### 什么是软件测试？

> 《GB/T15532 计算机软件测试规范》中对软件测试给出了定义：软件测试的目的是验证软件是否满足软件开发合同或项目开发计划、系统/子系统设计文档、软件需求规格说明、软件设计说明和软件产品说明等规定的软件质量要求；通过测试发现软件缺陷；为软件产品的质量评价提供依据。  

### 测试与调试的区别?

测试并不等于调试。测试需要有组织有计划的进行，其目的是为了发现缺陷并为软件产品的质量评价提供依据，而调试只是为了定位缺陷。

### 软件测试有效性

Glenford J . Myers在《The Art of Software Testing》一书中提到软件测试的目的：

+ 测试是为了证明程序有错，而不是证明程序无错；
+ 一个好的测试用例是在于它能发现至今未发现的错误；
+ 一个成功的测试是发现了至今未发现的错误的测试。

*那么没有发现缺陷的测试是有效测试吗？*
《GB/T 25000.10 系统与软件工程系统与软件质量要求和评价(SQuaRE) 第10部分：系统与软件质量模型》中，从**功能性、性能效率、兼容性、易用性、可靠性、信息安全性、维护性、可移植性**八个方面来评价软件的质量。只要在测试完成后有足够的证据证明软件符合这八个方面的要求，那么测试就是有效的。

### 谁为软件质量负责

从软件测试的二八原则来看，开发人员应该能够发现软件中80%的缺陷；而在开发人员未能发现的20%中，测试人员能够发现其中80%的缺陷；剩下4%的缺陷可能在用户使用过程中被发现，也有可能永远不会被发现。

### 软件测试分类

按照不同阶段分类：
> +**单元测试**：单元测试是针对软件设计的最小单位进行测试，这里的最小单位可以是模块，或面向对象编程中的类。目的是检查每个程序单元能否正确实现详细设计说明中的模块功能、性能、接口和设计约束等要求，发现各模块内部可能存在的各种错误。
> +**集成测试**：集成测试又称为组装测试。在单元测试的基础上，将各个程序单元进行有序、递增的组合测试。目的是验证软件单元之间、软件单元和已集成的软件系统之间的接口关系，并验证已集成的软件系统是否符合设计要求。
> +**确认测试**：确认测试是对已完成集成的软件系统进行测试。目的是验证软件系统本身是否与需求规格说明书中的要求一致。
> +**系统测试**：系统测试是在真实或模拟系统运行的环境下对集成了硬件和软件的系统进行测试。目的是检验系统在真实工作环境下的运行情况，以验证完整的软硬件系统能否实现用户的实际需求。
> +**验收测试**：验收测试是按照项目任务书或合同、供需双方约定的验收依据文档对整个系统进行测试以确定系统是否达到验收标准。验收测试的结论作为需要方是否接受该软件的主要依据。

按照是否需要了解内部结构划分：
> +**黑盒测试**：黑盒测试又称为数据驱动测试。在不了解软件的内部结构情况下，根据软件需求说明书中的要求设计测试用例，输入测试数据并验证输出结果，以验证软件表现是否与需求规格说明书中的要求一致。
> +**白盒测试**：白盒测试又称为逻辑驱动测试。对软件的结果进行分析，并设计测试用例，对软件的结构和执行路径进行检查，以验证软件是否能够按照设计说明书中的描述正常执行。
> +**灰盒测试**：灰盒测试也是一种数据驱动测试。与黑盒测试不同的是，根据需求规格说明书设计测试用例后，通过了解软件的内部结构补充测试用例，以提高测试的覆盖率。
***

## 单元测试概述

### 什么是单元测试

>单元测试是针对软件设计的最小单位进行测试。单元测试的“单元”在《GB/T15532 计算机软件测试规范》中的解释为“可独立编译或汇编的程序模块”。在实际操作中，可以认为承担一个单一职责的功能模块可以称为一个单元。

在C++中，通常情况下一个类会承担一个单一的职责，那么按类来划分单元是相对比较合理的。在C语言中，通常情况下一个文件中的代码会承担单一的职责，那么按文件来划分单元是相对比合理的。当然这不是绝对的，一个单元不能承担过多的指责，一个单元不能依赖太多其他的单元。

### TDD概述

**TDD全称测试驱动开发（Test-Driven Development）**，是一种增量式软件开发技术。即在没有失败的单元测试的前提下不可以写产品代码，开发产品代码的目的仅仅是为了让测试通过，依靠测试来推动开发的过程。

TDD开发过程如下：

+ 编写一个新的测试用例；
+ 编译代码，可能编译不通过；
+ 对功能代码做一部分改动，使得编译通过；
+ 运行所有测试，这时只有新的测试用例不通过；
+ 修改代码，让最新的测试用例通过；
+ 运行所有测试，确保所有测试用例通过；
+ 对代码进行重构，消除重复设计。

TDD可以帮助开发者解决很多没有单元测试的问题，然而TDD自身的缺点是显而易见的。首先是扭曲了开发的目标；其次让开发者做了很多无用功；最后TDD让开发者轻设计、重重构。
